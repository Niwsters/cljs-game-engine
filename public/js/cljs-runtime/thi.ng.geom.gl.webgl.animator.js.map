{"version":3,"sources":["thi/ng/geom/gl/webgl/animator.cljs"],"mappings":";AAEA,AAAKA,mDACH,iBAAAC,mBACC,AAAyBC;AAD1B,AAAA,oBAAAD;AAAAA;;AAAA,IAAAA,uBAEC,AAA+BC;AAFhC,AAAA,oBAAAD;AAAAA;;AAAA,IAAAA,uBAGC,AAA4BC;AAH7B,AAAA,oBAAAD;AAAAA;;AAAA,IAAAA,uBAIC,AAA2BC;AAJ5B,AAAA,oBAAAD;AAAAA;;AAKC,OAA0BC;;;;;;AAE7B,oCAAA,pCAAMC;AAAN,AAEE,IAAAF,mBACC,AAAMG;AADP,AAAA,oBAAAH;AAAAA;;AAAA,IAAAA,uBAEC,AAAYG;AAFb,AAAA,oBAAAH;AAAAA;;AAAA,IAAAA,uBAGC,AAASG;AAHV,AAAA,oBAAAH;AAAAA;;AAAA,IAAAA,uBAIC,AAAQG;AAJT,AAAA,oBAAAH;AAAAA;;AAKC,OAAOG;;;;;;AAEV,AAAA,wCAAA,gDAAAC,xFAAME;AAAN,AAAA,IAAAD,WAAA,AAAA;AAAA,AAAA,QAAAA;KAAA;AAAA,OAAAC,oEAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,oEAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;;AAAA,MAAA,KAAAC,MAAA,CAAA,8DAAA,AAAA;;;;;AAAA,CAAA,sEAAA,tEAAMD,iFACFE;AADJ,AAEG,6EAAA,tEAACC,oEAAQD;;;AAFZ,CAAA,sEAAA,tEAAMF,iFAGFE,EAAEE;AAHN,AAIG,IAAMC,KAAI,AAAU,KAAAC;IACdC,MAAI,yBAAA,zBAACC;IACLC,iBAAI;AAAA,AACE,oBAAI,iBAAAC,WAAG,iCAAA,hCAAG,CAAG,AAAU,KAAAJ,oBAAYD;IAA/BM,WAAyC,mDAAA,CAAA,4CAAA,hGAAQJ,oDAAAA;AAAjD,AAAA,0EAAAG,SAAAC,wBAAAD,SAAAC,5GAACT,kCAAAA,qDAAAA;;AACH,oBAAIE;AACF,QAACX,iFAAAA,sIAAAA,vDAAmBmB,kHAAAA,tEAASR,kHAAAA;;AAC7B,QAACX,iFAAAA,8HAAAA,/CAAmBmB,0GAAAA;;;AAHxB;;;AAHZ,AAOE,OAACH;;;AAXN,CAAA,gEAAA,hEAAMT;;AAAN","names":["thi.ng.geom.gl.webgl.animator/animframe-provider","or__5043__auto__","js/self","thi.ng.geom.gl.webgl.animator/now","js/performance","var_args","G__15950","thi.ng.geom.gl.webgl.animator/animate","js/Error","f","thi.ng.geom.gl.webgl.animator.animate","element","t0","js/Date","fid","cljs.core/volatile!","f'","G__15986","G__15987","animate*"],"sourcesContent":["(ns thi.ng.geom.gl.webgl.animator)\n\n(def animframe-provider\n  (or\n   (.-requestAnimationFrame js/self)\n   (.-webkitRequestAnimationFrame js/self)\n   (.-mozRequestAnimationFrame js/self)\n   (.-msRequestAnimationFrame js/self)\n   (.-oRequestAnimationFrame js/self)))\n\n(defn now\n  []\n  (or\n   (.now js/performance)\n   (.webkitNow js/performance)\n   (.mozNow js/performance)\n   (.msNow js/performance)\n   (.oNow js/performance)))\n\n(defn animate\n  ([f]\n   (animate f nil))\n  ([f element]\n   (let [t0  (.getTime (js/Date.))\n         fid (volatile! 0)\n         f'  (fn animate* []\n               (if (f (* (- (.getTime (js/Date.)) t0) 1e-3) (vswap! fid inc))\n                 (if element\n                   (animframe-provider animate* element)\n                   (animframe-provider animate*))))]\n     (f'))))\n"]}